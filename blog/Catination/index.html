<!DOCTYPE HTML>
<!--
	Prologue 1.1 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

	<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	<link rel="icon" href="/favicon.ico">

	<title>Catination</title>
	
<!-- Google Analytics -->
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54925912-1', 'auto');
  ga('send', 'pageview');

	</script>
	
<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

	<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
	
<!-- Latest compiled and minified JavaScript -->
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	
<!-- FontAwesome -->
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

<!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
<!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
	<script src="/assets/js/ie-emulation-modes-warning.js"></script>

	<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
 <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Custom styles for this template -->
	<link href="/carousel.css" rel="stylesheet">
	<link href="/post.css" rel="stylesheet">
	<link href="/syntax.css" rel="stylesheet">
  </head>

	<body>
		<!-- NAVBAR
================================================== -->
<body>
	<div class="navbar-wrapper">
		<div class="container">		
			<div class="navbar navbar-inverse navbar-static-top" role="navigation">
				<div class="container">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="/">
						<img class="img-grav" src="/assets/img/profile.jpg" alt="A picture of me.">  
						ProteinSim </a>
					</div>
					<div class="navbar-collapse collapse">
						<ul class="nav navbar-nav">
							
								<li><a href="/">Home</a></li>
								<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown"> Blog <span class="caret"></span></a>
								<ul class="dropdown-menu" role="menu">
									<li><a href="/blog/">Recent</a></li>
									<li class="divider"></li>
									<li><a href="/categories/">Categories</a></li>
								</ul>
								</li>
							
						</ul>
						<ul class="nav navbar-nav iconnav">
							<li class="icon-row"><a href="https://www.facebook.com/sshopkin" class="icon-link"><i class="fa fa-facebook-square social"></i></a></li>
							<li class="icon-row"><a href="https://www.linkedin.com/in/sawyerhopkins" class="icon-link"><i class="fa fa-linkedin-square social"></i></a></li>
							<li class="icon-row"><a href="https://github.com/SawyerHopkins" class="icon-link"><i class="fa fa-github-square social"></i></a></li>
							<li class="icon-row"><a href="mailto:sawyer@sawyerhopkins.com" class="icon-link"><i class="fa fa-envelope-square social"></i></a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
		    <!-- Carousel
    ================================================== -->
    <div id="myCarousel" class="carousel slide" data-ride="carousel">
      <div class="carousel-inner" role="listbox" style="background: url(/assets/img/sawyerheader.jpg) no-repeat top center fixed">
	  	
		<div class="item active">		
		

          <!--<img src="/assets/img/sawyerheader.png" class="img-responsive">-->
          <div class="container">
            <div class="carousel-caption">
              <h1><b><span class="carousel-text">Catination</span></b></h1>
              <p><span class="carousel-text">Pagination for post categories in Jekyll.</span></p>
            </div>
          </div>
        </div>		
		
	</div>	
    </div><!-- /.carousel -->
		
		<!-- Main -->
			<div id="main">
				<div class="container marketing">
			      <div class="post-block">

<p class="post-header">Categories in Jekyll</p>
	
<p class="post-para">I realized that I would like to add the ability for users to search my blog by post category, however Jekyll does not provide a built in method for creating paginated lists of post by category. So I opened up the Jekyll source scripts to figure out what all makes pagination tick and modified it to create pages for categories. The Jekyll script for pagination is under the <i>jekyll-paginate</i> gem and uses two scripts: <i>pager.rb</i> and <i>pagination.rb</i>. After looking through these scripts, I figured that I could get away with leaving the pager class alone and simply making a few changes to the pagination class. This modified class I have dubbed to be <i>catination.rb</i>.</p>
	
<!--more-->	
	
<p class="post-header">Making Catination</p>

<p class="post-para"> The code below is the original paginate function. The function takes two arguments: <i>site</i> which, as you might expect, is basically the all the information for the entire site, and <i>page</i> which is a reference to the template base page for pagination.</p>

<div class="post-para">
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno"> 1</span> <span class="k">def</span> <span class="nf">paginate</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span>
<span class="lineno"> 2</span> 	<span class="n">all_posts</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">site_payload</span><span class="o">[</span><span class="s1">&#39;site&#39;</span><span class="o">][</span><span class="s1">&#39;posts&#39;</span><span class="o">]</span>
<span class="lineno"> 3</span> 	<span class="n">pages</span> <span class="o">=</span> <span class="no">Pager</span><span class="o">.</span><span class="n">calculate_pages</span><span class="p">(</span><span class="n">all_posts</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="o">[</span><span class="s1">&#39;paginate&#39;</span><span class="o">].</span><span class="n">to_i</span><span class="p">)</span>
<span class="lineno"> 4</span> 	<span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.pages</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">num_page</span><span class="o">|</span>
<span class="lineno"> 5</span> 		<span class="n">pager</span> <span class="o">=</span> <span class="no">Pager</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">num_page</span><span class="p">,</span> <span class="n">all_posts</span><span class="p">,</span> <span class="n">pages</span><span class="p">)</span>
<span class="lineno"> 6</span> 		<span class="k">if</span> <span class="n">num_page</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="lineno"> 7</span> 			<span class="n">newpage</span> <span class="o">=</span> <span class="no">Page</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">dir</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="lineno"> 8</span> 			<span class="n">newpage</span><span class="o">.</span><span class="n">pager</span> <span class="o">=</span> <span class="n">pager</span>
<span class="lineno"> 9</span> 			<span class="n">newpage</span><span class="o">.</span><span class="n">dir</span> <span class="o">=</span> <span class="no">Pager</span><span class="o">.</span><span class="n">paginate_path</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">num_page</span><span class="p">)</span>
<span class="lineno">10</span>             <span class="n">site</span><span class="o">.</span><span class="n">pages</span> <span class="o">&lt;&lt;</span> <span class="n">newpage</span>
<span class="lineno">11</span> 		<span class="k">else</span>
<span class="lineno">12</span>             <span class="n">page</span><span class="o">.</span><span class="n">pager</span> <span class="o">=</span> <span class="n">pager</span>
<span class="lineno">13</span> 		<span class="k">end</span>
<span class="lineno">14</span> 	<span class="k">end</span>
<span class="lineno">15</span> <span class="k">end</span></code></pre></div>
</div>

<p class="post-para">And here is the catinate function. It looks a bit more complicated as I blew it up with comments to break down what is actually going on, but really I just encapsulated the original code in another loop that iterates across all categories.</p>

<div class="post-para">
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno"> 1</span> <span class="k">def</span> <span class="nf">catinate</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span>
<span class="lineno"> 2</span> 	<span class="c1">#Gets a hash of with category names as keys and an array corresponding posts as a value.</span>
<span class="lineno"> 3</span> 	<span class="n">all_cats</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">site_payload</span><span class="o">[</span><span class="s1">&#39;site&#39;</span><span class="o">][</span><span class="s1">&#39;categories&#39;</span><span class="o">]</span>
<span class="lineno"> 4</span> 	<span class="c1">#Feed each key value pair into a modified pagination function.</span>
<span class="lineno"> 5</span> 	<span class="n">all_cats</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
<span class="lineno"> 6</span> 		<span class="c1">#Makes sure bad things didn&#39;t happen.</span>
<span class="lineno"> 7</span> 		<span class="k">if</span> <span class="o">!</span><span class="n">key</span><span class="o">.</span><span class="n">nil?</span>
<span class="lineno"> 8</span> 			<span class="c1">#This returns how many pages are to be generated</span>
<span class="lineno"> 9</span> 			<span class="c1">#Ceil[(Number of Posts in Category) / (Paginate Value)]</span>
<span class="lineno">10</span> 			<span class="n">pages</span> <span class="o">=</span> <span class="no">Pager</span><span class="o">.</span><span class="n">calculate_pages</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="o">[</span><span class="s1">&#39;paginate&#39;</span><span class="o">].</span><span class="n">to_i</span><span class="p">)</span>
<span class="lineno">11</span> 			<span class="no">Jekyll</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warn</span> <span class="s2">&quot;Catination:&quot;</span> <span class="s2">&quot; creating &quot;</span> <span class="o">+</span> <span class="n">pages</span><span class="o">.</span><span class="n">to_s</span> <span class="o">+</span> <span class="s2">&quot; pages for category - &quot;</span> <span class="o">+</span> <span class="n">key</span>
<span class="lineno">12</span> 			<span class="c1">#Creates each page</span>
<span class="lineno">13</span> 			<span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.pages</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">num_page</span><span class="o">|</span>
<span class="lineno">14</span> 				<span class="c1">#Creates the paging object</span>
<span class="lineno">15</span>                 <span class="n">pager</span> <span class="o">=</span> <span class="no">Pager</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">num_page</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">pages</span><span class="p">)</span>
<span class="lineno">16</span>                 <span class="c1">#If there is more than one page</span>
<span class="lineno">17</span>                 <span class="c1">#Create the standard pagination layout</span>
<span class="lineno">18</span>                 <span class="k">if</span> <span class="n">num_page</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="lineno">19</span> 					<span class="n">newpage</span> <span class="o">=</span> <span class="no">Page</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">dir</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="lineno">20</span> 					<span class="n">newpage</span><span class="o">.</span><span class="n">pager</span> <span class="o">=</span> <span class="n">pager</span>
<span class="lineno">21</span> 					<span class="n">newpage</span><span class="o">.</span><span class="n">dir</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="o">[</span><span class="s2">&quot;catinate_out&quot;</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;/page&quot;</span> <span class="o">+</span> <span class="n">num_page</span><span class="o">.</span><span class="n">to_s</span>
<span class="lineno">22</span> 					<span class="n">site</span><span class="o">.</span><span class="n">pages</span> <span class="o">&lt;&lt;</span> <span class="n">newpage</span>
<span class="lineno">23</span>                 <span class="c1">#Create a sub-directory for each key</span>
<span class="lineno">24</span>                 <span class="k">else</span>
<span class="lineno">25</span> 					<span class="n">newpage</span> <span class="o">=</span> <span class="no">Page</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">site</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">dir</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="lineno">26</span> 					<span class="n">newpage</span><span class="o">.</span><span class="n">pager</span> <span class="o">=</span> <span class="n">pager</span>
<span class="lineno">27</span> 					<span class="n">newpage</span><span class="o">.</span><span class="n">dir</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="o">[</span><span class="s2">&quot;catinate_out&quot;</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">key</span>
<span class="lineno">28</span> 					<span class="n">site</span><span class="o">.</span><span class="n">pages</span> <span class="o">&lt;&lt;</span> <span class="n">newpage</span>
<span class="lineno">29</span>                 <span class="k">end</span>
<span class="lineno">30</span>             <span class="k">end</span>
<span class="lineno">31</span>         <span class="k">end</span>
<span class="lineno">32</span>     <span class="k">end</span>
<span class="lineno">33</span> <span class="k">end</span></code></pre></div>
</div>

<p class="post-para"> The problem here is that <i>site.site_payload['site']['categories']</i> returns a hash. That works fine for the pagination, but it makes creating a sorted list of all categories with liquid difficult as hashes don't have a generic sorting comparator. Luckily hashes do implement enumerable in ruby, so it was pretty straight forward to make a new liquid filter that returns sorted hashes in either ascending or descending order.</p>

<div class="post-para">
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno"> 1</span> <span class="k">module</span> <span class="nn">Jekyll</span>
<span class="lineno"> 2</span>   <span class="k">module</span> <span class="nn">SortedCategories</span>
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span>     <span class="c1">#Sorts categories so that those with the most posts are on the top of the stack</span>
<span class="lineno"> 5</span>     <span class="k">def</span> <span class="nf">sort_most_post</span><span class="p">(</span><span class="n">catHash</span><span class="p">)</span>
<span class="lineno"> 6</span>       <span class="no">Jekyll</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warn</span> <span class="s2">&quot;Catination:&quot;</span><span class="p">,</span> <span class="s2">&quot;Sorting categories by post count.&quot;</span>
<span class="lineno"> 7</span>       <span class="n">catHash</span><span class="o">.</span><span class="n">sort</span> <span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">|</span> <span class="n">y</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;=&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">size</span> <span class="p">}</span>
<span class="lineno"> 8</span>     <span class="k">end</span>
<span class="lineno"> 9</span> 
<span class="lineno">10</span>     <span class="c1">#Sorts categories so that those with the most posts are on the bottom of the stack</span>
<span class="lineno">11</span>     <span class="k">def</span> <span class="nf">sort_least_post</span><span class="p">(</span><span class="n">catHash</span><span class="p">)</span>
<span class="lineno">12</span>       <span class="no">Jekyll</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warn</span> <span class="s2">&quot;Catination:&quot;</span><span class="p">,</span> <span class="s2">&quot;Sorting categories by post count.&quot;</span>
<span class="lineno">13</span>       <span class="n">catHash</span><span class="o">.</span><span class="n">sort</span> <span class="p">{</span><span class="o">|</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">|</span> <span class="n">x</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;=&gt;</span> <span class="n">y</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">size</span> <span class="p">}</span>
<span class="lineno">14</span>     <span class="k">end</span>
<span class="lineno">15</span> 
<span class="lineno">16</span>   <span class="k">end</span>
<span class="lineno">17</span> <span class="k">end</span>
<span class="lineno">18</span> 
<span class="lineno">19</span> <span class="no">Liquid</span><span class="o">::</span><span class="no">Template</span><span class="o">.</span><span class="n">register_filter</span><span class="p">(</span><span class="no">Jekyll</span><span class="o">::</span><span class="no">SortedCategories</span><span class="p">)</span></code></pre></div>
</div>

<p class="post-para"> That's all I got for this. Jekyll has a pretty solid core which makes creating plug-ins a breeze. The only problem was that GitHub Pages (for obvious reasons) runs Jekyll in safe mode which means my plug-ins don't get executed. I fixed this by creating a new project for the Jekyll source, building the site locally, and letting Jekyll output the site into the GitHub Pages project folder. This code is available as a project on my GitHub profile, and as always the gist link is below.</p>

</div>
				
				<div style="margin-top:25px">
				
				<b>Like this post? <a href="/gists/Catination">Get the Gist</a></b>.
				  
				</div>

				
				 <div class="social-sharing">
	
	<div class="share-button text">
	Share
	</div>
	<div class="share-button twitter">
		<a href="https://twitter.com/home?status=/blog/Catination " target="_blank"><i class="fa fa-twitter social"></i></a>
	</div>
	<div class="share-button linkedin">
		<a href="http://www.linkedin.com/shareArticle?mini=true&url=/blog/Catination&title=Catination&summary=Pagination for post categories in Jekyll.&source=SawyerHopkins.com" target="_blank"><i class="fa fa-linkedin social"></i></a>
	</div>
	<div class="share-button gplus">
		<a href="https://plus.google.com/share?url=/blog/Catination" target="_blank"><i class="fa fa-google-plus social"></i></a>
	</div>
	
</div>
				  
				  
					<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'sawyerhopkins'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
     
				  
				  
				</div>
			</div>
			
		
		
	</body>
</html>