<!DOCTYPE HTML>
<!--
	Prologue 1.1 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

	<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	<link rel="icon" href="/favicon.ico">

	<title>NIntegrate Plots</title>
	
<!-- Google Analytics -->
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54925912-1', 'auto');
  ga('send', 'pageview');

	</script>
	
<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

	<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
	
<!-- Latest compiled and minified JavaScript -->
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	
<!-- FontAwesome -->
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

<!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
<!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
	<script src="/assets/js/ie-emulation-modes-warning.js"></script>

	<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
 <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Custom styles for this template -->
	<link href="/carousel.css" rel="stylesheet">
	<link href="/post.css" rel="stylesheet">
	<link href="/syntax.css" rel="stylesheet">
  </head>

	<body>
		<!-- NAVBAR
================================================== -->
<body>
	<div class="navbar-wrapper">
		<div class="container">		
			<div class="navbar navbar-inverse navbar-static-top" role="navigation">
				<div class="container">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="/">
						<img class="img-grav" src="/assets/img/profile.jpg" alt="A picture of me.">  
						ProteinSim </a>
					</div>
					<div class="navbar-collapse collapse">
						<ul class="nav navbar-nav">
							
								<li><a href="/">Home</a></li>
								<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown"> Blog <span class="caret"></span></a>
								<ul class="dropdown-menu" role="menu">
									<li><a href="/blog/">Recent</a></li>
									<li class="divider"></li>
									<li><a href="/categories/">Categories</a></li>
								</ul>
								</li>
							
						</ul>
						<ul class="nav navbar-nav iconnav">
							<li class="icon-row"><a href="https://www.facebook.com/sshopkin" class="icon-link"><i class="fa fa-facebook-square social"></i></a></li>
							<li class="icon-row"><a href="https://www.linkedin.com/in/sawyerhopkins" class="icon-link"><i class="fa fa-linkedin-square social"></i></a></li>
							<li class="icon-row"><a href="https://github.com/SawyerHopkins" class="icon-link"><i class="fa fa-github-square social"></i></a></li>
							<li class="icon-row"><a href="mailto:sawyer@sawyerhopkins.com" class="icon-link"><i class="fa fa-envelope-square social"></i></a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
		    <!-- Carousel
    ================================================== -->
    <div id="myCarousel" class="carousel slide" data-ride="carousel">
      <div class="carousel-inner" role="listbox" style="background: url(/assets/img/sawyerheader.jpg) no-repeat top center fixed">
	  	
		<div class="item active">		
		

          <!--<img src="/assets/img/sawyerheader.png" class="img-responsive">-->
          <div class="container">
            <div class="carousel-caption">
              <h1><b><span class="carousel-text">NIntegrate Plots</span></b></h1>
              <p><span class="carousel-text">Using ListPlot to create plots for non-analytic integrals.</span></p>
            </div>
          </div>
        </div>		
		
	</div>	
    </div><!-- /.carousel -->
		
		<!-- Main -->
			<div id="main">
				<div class="container marketing">
			      <div class="post-block">

<p class="post-header">Wave Functions in Free Space</p>
	
<p class="post-para">Consider a Gaussian wave packet in free space. I will use this as a simple example to demonstrate the use of NIntegrate and ListPlot in Mathematica to create plots of wave functions that are non-analytic or take longer than desired to compute analytically. Since I am using a wave packet in free space I can project the packet onto the eigenstates with a Fourier Transform. This allows me to use Mathematica's existing functions to construct a time dependant wave function.</p>
	
<!--more-->		

<div class="post-para">
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno">1</span> <span class="n">free</span><span class="o">[</span><span class="n">x_</span><span class="o">]</span> <span class="o">=</span> <span class="no">Exp</span><span class="o">[-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">]*</span><span class="no">Exp</span><span class="o">[-</span><span class="n">I</span><span class="o">*</span><span class="n">x</span><span class="o">]</span><span class="p">;</span>
<span class="lineno">2</span> <span class="n">freetd</span><span class="o">[</span><span class="n">x_</span><span class="p">,</span> <span class="n">t_</span><span class="o">]</span> <span class="o">=</span> 
<span class="lineno">3</span>   <span class="no">InverseFourierTransform</span><span class="o">[</span>
<span class="lineno">4</span>    <span class="no">FourierTransform</span><span class="o">[</span><span class="n">free</span><span class="o">[</span><span class="n">x</span><span class="o">]</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="o">]*</span><span class="no">Exp</span><span class="o">[</span><span class="n">I</span><span class="o">*</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">]</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="o">]</span><span class="p">;</span>
<span class="lineno">5</span> <span class="n">fstarf</span><span class="o">[</span><span class="n">x_</span><span class="p">,</span> <span class="n">t_</span><span class="o">]</span> <span class="o">=</span> <span class="n">freetd</span><span class="o">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">]*</span><span class="no">Conjugate</span><span class="o">[</span><span class="n">freetd</span><span class="o">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">]]</span><span class="p">;</span>
<span class="lineno">6</span> <span class="no">Plot</span><span class="o">[</span><span class="n">fstarf</span><span class="o">[</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span> <span class="no">PlotRange</span> <span class="o">-&gt;</span> <span class="no">Full</span><span class="o">]</span></code></pre></div>
</div>

<div class="post-para">
<img class="featurette-image img-responsive post-center-type" src="/assets/img/ListPlot/fourier_plot.png" alt="Plot using Fourier Transforms for a free wave packet.">
</div>

<p class="post-para">However this is a special case. In general it would be necessary to project the initial wave packet onto the eigenstates manually with an appropriate integral. In this case I can plot my momentum space distribution to see that it only exists in a small range, allowing me to integrate over a smaller region of space.</p>

<div class="post-para">
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno">1</span> <span class="nb">p</span><span class="o">[</span><span class="n">k_</span><span class="p">,</span> <span class="n">t_</span><span class="o">]</span> <span class="o">=</span> 
<span class="lineno">2</span>   <span class="mi">1</span><span class="o">/</span><span class="no">Sqrt</span><span class="o">[</span><span class="mi">2</span><span class="o">*</span><span class="p">\</span><span class="o">[</span><span class="no">Pi</span><span class="o">]]</span> <span class="no">Integrate</span><span class="o">[</span>
<span class="lineno">3</span>     <span class="n">f</span><span class="o">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">]*</span><span class="no">Exp</span><span class="o">[</span><span class="n">I</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">]</span><span class="p">,</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="p">\</span><span class="o">[</span><span class="no">Infinity</span><span class="o">]</span><span class="p">,</span> <span class="p">\</span><span class="o">[</span><span class="no">Infinity</span><span class="o">]</span><span class="p">}</span><span class="o">]*</span><span class="no">Exp</span><span class="o">[</span><span class="n">I</span><span class="o">*</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">]</span><span class="p">;</span>
<span class="lineno">4</span> <span class="no">Plot</span><span class="o">[</span><span class="nb">p</span><span class="o">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="p">{</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">}</span><span class="o">]</span>
<span class="lineno">5</span> 
<span class="lineno">6</span> <span class="n">freetd</span><span class="o">[</span><span class="n">x_</span><span class="p">,</span> <span class="n">t_</span><span class="o">]</span> <span class="o">=</span> 
<span class="lineno">7</span>   <span class="mi">1</span><span class="o">/</span><span class="no">Sqrt</span><span class="o">[</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">\</span><span class="o">[</span><span class="no">Pi</span><span class="o">]</span><span class="p">)</span><span class="o">]</span> <span class="no">Integrate</span><span class="o">[</span><span class="nb">p</span><span class="o">[</span><span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="o">]*</span><span class="no">Exp</span><span class="o">[-</span><span class="n">I</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">]</span><span class="p">,</span> <span class="p">{</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">}</span><span class="o">]</span><span class="p">;</span>
<span class="lineno">8</span> <span class="n">fstarf</span><span class="o">[</span><span class="n">x_</span><span class="p">,</span> <span class="n">t_</span><span class="o">]</span> <span class="o">=</span> <span class="n">freetd</span><span class="o">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">]*</span><span class="no">Conjugate</span><span class="o">[</span><span class="n">freetd</span><span class="o">[</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">]]</span><span class="p">;</span>
<span class="lineno">9</span> <span class="no">Plot</span><span class="o">[</span><span class="n">fstarf</span><span class="o">[</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">]</span><span class="p">,</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">},</span> <span class="no">PlotRange</span> <span class="o">-&gt;</span> <span class="no">Full</span><span class="o">]</span></code></pre></div>
</div>

<div class="post-para">
<img class="featurette-image img-responsive post-center-type" src="/assets/img/ListPlot/momentum_plot.png" alt="Plot using Fourier Transforms for a free wave packet.">
</div>

<p class="post-para">Sometimes simplification is not possible and a numerical approach is needed. Here this requires integrating at both a constant value of time as well as position. Since we want to construct a position space wave function we can use a table to iterate over a range of discrete positions.</p>

<div class="post-para">
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="lineno">1</span> <span class="n">base</span><span class="o">[</span><span class="n">k_</span><span class="p">,</span> <span class="n">t_</span><span class="p">,</span> <span class="n">x_</span><span class="o">]</span> <span class="o">=</span> <span class="nb">p</span><span class="o">[</span><span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="o">]*</span><span class="no">Exp</span><span class="o">[-</span><span class="n">I</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">]</span>
<span class="lineno">2</span> <span class="n">data</span> <span class="o">=</span> <span class="no">Table</span><span class="o">[</span>
<span class="lineno">3</span>    <span class="no">NIntegrate</span><span class="o">[</span><span class="n">base</span><span class="o">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">]</span><span class="p">,</span> <span class="p">{</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="p">\</span><span class="o">[</span><span class="no">Infinity</span><span class="o">]</span><span class="p">,</span> <span class="p">\</span><span class="o">[</span><span class="no">Infinity</span><span class="o">]</span><span class="p">}</span><span class="o">]</span><span class="p">,</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> 
<span class="lineno">4</span>     <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="p">}</span><span class="o">]</span><span class="p">;</span>
<span class="lineno">5</span> <span class="n">xaxis</span> <span class="o">=</span> <span class="no">Table</span><span class="o">[</span><span class="n">i</span><span class="p">,</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="p">}</span><span class="o">]</span><span class="p">;</span>
<span class="lineno">6</span> <span class="n">yaxis</span> <span class="o">=</span> <span class="no">Re</span><span class="o">[</span><span class="n">data</span><span class="o">*</span><span class="no">Conjugate</span><span class="o">[</span><span class="n">data</span><span class="o">]]</span><span class="p">;</span>
<span class="lineno">7</span> <span class="n">points</span> <span class="o">=</span> <span class="no">Transpose</span><span class="o">[</span><span class="p">{</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">yaxis</span><span class="p">}</span><span class="o">]</span><span class="p">;</span>
<span class="lineno">8</span> <span class="no">ListPlot</span><span class="o">[</span><span class="n">points</span><span class="o">]</span></code></pre></div>
</div>

<div class="post-para">
<img class="featurette-image img-responsive post-center-type" src="/assets/img/ListPlot/listplot.png" alt="Plot using Fourier Transforms for a free wave packet.">
</div>

<p class="post-para"> After using 'Table' to create an array of wave function values, we need to use it again to create an array of the corresponding positions. Using transpose we create an ordered pair which associates the probability amplitude matrix (<i>yaxis</i>) with the position matrix (<i>xaxis</i>). ListPlot will then make a discrete plot of the probability amplitude.</p>

</div>
				
				<div style="margin-top:25px">
				  
				</div>

				
				 <div class="social-sharing">
	
	<div class="share-button text">
	Share
	</div>
	<div class="share-button twitter">
		<a href="https://twitter.com/home?status=/blog/NIntegrate-Plots " target="_blank"><i class="fa fa-twitter social"></i></a>
	</div>
	<div class="share-button linkedin">
		<a href="http://www.linkedin.com/shareArticle?mini=true&url=/blog/NIntegrate-Plots&title=NIntegrate Plots&summary=Using ListPlot to create plots for non-analytic integrals.&source=SawyerHopkins.com" target="_blank"><i class="fa fa-linkedin social"></i></a>
	</div>
	<div class="share-button gplus">
		<a href="https://plus.google.com/share?url=/blog/NIntegrate-Plots" target="_blank"><i class="fa fa-google-plus social"></i></a>
	</div>
	
</div>
				  
				  
					<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'sawyerhopkins'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
     
				  
				  
				</div>
			</div>
			
		
		
	</body>
</html>